{
  "children": [
    {
      "data": {
        "ce_status": "execed",
        "entries": [
          [
            "\"\"\"\n==============\nCanvasAgg demo\n==============\n\nThis example shows how to use the agg backend directly to create images, which\nmay be of use to web application developers who want full control over their\ncode without using the pyplot interface to manage figures, figure closing etc.\n\n.. note::\n\n    It is not necessary to avoid using the pyplot interface in order to\n    create figures without a graphical front-end - simply setting\n    the backend to \"Agg\" would be sufficient.\n\nIn this example, we show how to save the contents of the agg canvas to a file,\nand how to extract them to a numpy array, which can in turn be passed off\nto Pillow_.  The latter functionality allows e.g. to use Matplotlib inside a\ncgi-script *without* needing to write a figure to disk, and to write images in\nany format supported by Pillow.\n\n.. _Pillow: https://pillow.readthedocs.io/\n.. redirect-from:: /gallery/misc/agg_buffer\n.. redirect-from:: /gallery/misc/agg_buffer_to_array\n\"\"\"",
            "",
            "sd"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "from",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "matplotlib",
            "matplotlib",
            "nn"
          ],
          [
            ".",
            "",
            "nn"
          ],
          [
            "backends",
            "matplotlib.backends",
            "nn"
          ],
          [
            ".",
            "",
            "nn"
          ],
          [
            "backend_agg",
            "matplotlib.backends.backend_agg",
            "nn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "import",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "FigureCanvasAgg",
            "matplotlib.backends.backend_agg.FigureCanvasAgg",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "from",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "matplotlib",
            "matplotlib",
            "nn"
          ],
          [
            ".",
            "",
            "nn"
          ],
          [
            "figure",
            "matplotlib.figure",
            "nn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "import",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "Figure",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "import",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "numpy",
            "numpy",
            "nn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "as",
            null,
            "k"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "np",
            "numpy",
            "nn"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "from",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "PIL",
            "PIL",
            "nn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "import",
            null,
            "kn"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "Image",
            "PIL.Image",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "fig",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "Figure",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "figsize",
            null,
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "5",
            "",
            "mi"
          ],
          [
            ",",
            "",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "4",
            "",
            "mi"
          ],
          [
            ")",
            "",
            ""
          ],
          [
            ",",
            "",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "dpi",
            null,
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            "100",
            "",
            "mi"
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# A canvas must be manually attached to the figure (pyplot would automatically",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# do it).  This is done by instantiating the canvas with the figure as",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# argument.",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "canvas",
            "matplotlib.backends.backend_agg.FigureCanvasAgg",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "FigureCanvasAgg",
            "matplotlib.backends.backend_agg.FigureCanvasAgg",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "fig",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# Do some plotting.",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "ax",
            null,
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "fig",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "add_subplot",
            "matplotlib.figure.FigureBase.add_subplot",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "ax",
            null,
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "plot",
            null,
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "[",
            "",
            ""
          ],
          [
            "1",
            "",
            "mi"
          ],
          [
            ",",
            "",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "2",
            "",
            "mi"
          ],
          [
            ",",
            "",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "3",
            "",
            "mi"
          ],
          [
            "]",
            "",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# Option 1: Save the figure to a file; can also be a file-like object (BytesIO,",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# etc.).",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "fig",
            "matplotlib.figure.Figure",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "savefig",
            "matplotlib.figure.Figure.savefig",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "\"",
            "",
            "s2"
          ],
          [
            "test.png",
            "",
            "s2"
          ],
          [
            "\"",
            "",
            "s2"
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# Option 2: Retrieve a memoryview on the renderer buffer, and convert it to a",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# numpy array.",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "canvas",
            "matplotlib.backends.backend_agg.FigureCanvasAgg",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "draw",
            "matplotlib.backends.backend_agg.FigureCanvasAgg.draw",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "rgba",
            "numpy.ndarray",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "np",
            "numpy",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "asarray",
            "numpy.asarray",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "canvas",
            "matplotlib.backends.backend_agg.FigureCanvasAgg",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "buffer_rgba",
            "matplotlib.backends.backend_agg.FigureCanvasAgg.buffer_rgba",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# ... and pass it to PIL.",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "im",
            "PIL.Image.Image",
            ""
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "=",
            "",
            "o"
          ],
          [
            " ",
            "",
            ""
          ],
          [
            "Image",
            "PIL.Image",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "fromarray",
            "PIL.Image.fromarray",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "rgba",
            "numpy.ndarray",
            ""
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# This image can then be saved to any format supported by Pillow, e.g.:",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "im",
            "PIL.Image.Image",
            ""
          ],
          [
            ".",
            "",
            "o"
          ],
          [
            "save",
            "PIL.Image.Image.save",
            ""
          ],
          [
            "(",
            "",
            ""
          ],
          [
            "\"",
            "",
            "s2"
          ],
          [
            "test.bmp",
            "",
            "s2"
          ],
          [
            "\"",
            "",
            "s2"
          ],
          [
            ")",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# Uncomment this line to display the image using ImageMagick's `display` tool.",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# im.show()",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#############################################################################",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "# .. admonition:: References",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    The use of the following functions, methods, classes and modules is shown",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    in this example:",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    - `matplotlib.backends.backend_agg.FigureCanvasAgg`",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    - `matplotlib.figure.Figure`",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    - `matplotlib.figure.Figure.add_subplot`",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    - `matplotlib.figure.Figure.savefig` / `matplotlib.pyplot.savefig`",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ],
          [
            "#    - `matplotlib.axes.Axes.plot` / `matplotlib.pyplot.plot`",
            "",
            "c1"
          ],
          [
            "\n",
            "",
            ""
          ]
        ],
        "out": ""
      },
      "type": "Code"
    }
  ],
  "title": null
}