{
  "aliases": [],
  "arbitrary": [
    {
      "children": [],
      "level": 0,
      "target": null,
      "title": "CPU build options",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "The following options are mainly used to change the default behavior of optimizations that target certain CPU features:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "dd": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "Default value is "
                            },
                            {
                              "type": "inlineCode",
                              "value": "min"
                            },
                            {
                              "type": "text",
                              "value": " which provides the minimum CPU features that can    safely run on a wide range of platforms within the processor family."
                            }
                          ],
                          "type": "paragraph"
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "type": "text",
                                  "value": "note "
                                }
                              ],
                              "type": "admonitionTitle"
                            },
                            {
                              "children": [
                                {
                                  "dd": [
                                    {
                                      "children": [
                                        {
                                          "type": "text",
                                          "value": "are not supported by the target CPU (raises Python runtime error)."
                                        }
                                      ],
                                      "type": "paragraph"
                                    }
                                  ],
                                  "dt": {
                                    "children": [
                                      {
                                        "type": "text",
                                        "value": "During the runtime, NumPy modules will fail to load if any of specified features"
                                      }
                                    ],
                                    "type": "paragraph"
                                  },
                                  "type": "DefListItem"
                                }
                              ],
                              "type": "DefList"
                            }
                          ],
                          "kind": "note",
                          "type": "admonition"
                        }
                      ],
                      "dt": {
                        "children": [
                          {
                            "type": "inlineCode",
                            "value": "--cpu-baseline"
                          },
                          {
                            "type": "text",
                            "value": ": minimal set of required CPU features."
                          }
                        ],
                        "type": "paragraph"
                      },
                      "type": "DefListItem"
                    }
                  ],
                  "type": "DefList"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "dd": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "Default value is "
                            },
                            {
                              "type": "inlineCode",
                              "value": "max -xop -fma4"
                            },
                            {
                              "type": "text",
                              "value": " which enables all CPU    features, except for AMD legacy features (in case of X86)."
                            }
                          ],
                          "type": "paragraph"
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "type": "text",
                                  "value": "note "
                                }
                              ],
                              "type": "admonitionTitle"
                            },
                            {
                              "children": [
                                {
                                  "dd": [
                                    {
                                      "children": [
                                        {
                                          "type": "text",
                                          "value": "that are not available in the target CPU."
                                        }
                                      ],
                                      "type": "paragraph"
                                    }
                                  ],
                                  "dt": {
                                    "children": [
                                      {
                                        "type": "text",
                                        "value": "During the runtime, NumPy modules will skip any specified features"
                                      }
                                    ],
                                    "type": "paragraph"
                                  },
                                  "type": "DefListItem"
                                }
                              ],
                              "type": "DefList"
                            }
                          ],
                          "kind": "note",
                          "type": "admonition"
                        }
                      ],
                      "dt": {
                        "children": [
                          {
                            "type": "inlineCode",
                            "value": "--cpu-dispatch"
                          },
                          {
                            "type": "text",
                            "value": ": dispatched set of additional CPU features."
                          }
                        ],
                        "type": "paragraph"
                      },
                      "type": "DefListItem"
                    }
                  ],
                  "type": "DefList"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "These options are accessible through "
            },
            {
              "type": "inlineCode",
              "value": "distutils"
            },
            {
              "type": "text",
              "value": " commands "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "module",
              "reference": {
                "kind": "api",
                "module": "distutils",
                "path": "distutils.command.build",
                "type": "RefInfo",
                "version": "*"
              },
              "type": "Link",
              "value": "distutils.command.build"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "module",
              "reference": {
                "kind": "api",
                "module": "distutils",
                "path": "distutils.command.build_clib",
                "type": "RefInfo",
                "version": "*"
              },
              "type": "Link",
              "value": "distutils.command.build_clib"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "module",
              "reference": {
                "kind": "api",
                "module": "distutils",
                "path": "distutils.command.build_ext",
                "type": "RefInfo",
                "version": "*"
              },
              "type": "Link",
              "value": "distutils.command.build_ext"
            },
            {
              "type": "text",
              "value": ". They accept a set of "
            },
            {
              "type": "inlineCode",
              "value": "CPU features <opt-supported-features>"
            },
            {
              "type": "text",
              "value": " or groups of features that gather several features or "
            },
            {
              "type": "inlineCode",
              "value": "special options <opt-special-options>"
            },
            {
              "type": "text",
              "value": " that perform a series of procedures."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "If "
                },
                {
                  "type": "inlineCode",
                  "value": "build_clib"
                },
                {
                  "type": "text",
                  "value": " or "
                },
                {
                  "type": "inlineCode",
                  "value": "build_ext"
                },
                {
                  "type": "text",
                  "value": " are not specified by the user, the arguments of "
                },
                {
                  "type": "inlineCode",
                  "value": "build"
                },
                {
                  "type": "text",
                  "value": " will be used instead, which also holds the default values."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "To customize both "
            },
            {
              "type": "inlineCode",
              "value": "build_ext"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "build_clib"
            },
            {
              "type": "text",
              "value": "      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "cd /path/to/numpy\npython setup.py build --cpu-baseline=\"avx2 fma3\" install --user"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "To customize only "
            },
            {
              "type": "inlineCode",
              "value": "build_ext"
            },
            {
              "type": "text",
              "value": "      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "cd /path/to/numpy\npython setup.py build_ext --cpu-baseline=\"avx2 fma3\" install --user"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "To customize only "
            },
            {
              "type": "inlineCode",
              "value": "build_clib"
            },
            {
              "type": "text",
              "value": "      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "cd /path/to/numpy\npython setup.py build_clib --cpu-baseline=\"avx2 fma3\" install --user"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "You can also customize CPU/build options through PIP command      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "pip install --no-use-pep517 --global-option=build \\\n--global-option=\"--cpu-baseline=avx2 fma3\" \\\n--global-option=\"--cpu-dispatch=max\" ./"
        }
      ],
      "level": 1,
      "target": null,
      "title": "Description",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "In general, the default settings tend to not impose certain CPU features that may not be available on some older processors. Raising the ceiling of the baseline features will often improve performance and may also reduce binary size."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "The following are the most common scenarios that may require changing the default settings:"
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 1,
      "target": null,
      "title": "Quick Start",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "And I do not intend to export the build to other users or target a different CPU than what the host has."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "Set "
            },
            {
              "domain": null,
              "role": null,
              "type": "Directive",
              "value": "native"
            },
            {
              "type": "text",
              "value": " for baseline, or manually specify the CPU features in case of option "
            },
            {
              "domain": null,
              "role": null,
              "type": "Directive",
              "value": "native"
            },
            {
              "type": "text",
              "value": " isn't supported by your platform      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "python setup.py build --cpu-baseline=\"native\" bdist"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "Building NumPy with extra CPU features isn't necessary for this case, since all supported features are already defined within the baseline features      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "python setup.py build --cpu-baseline=native --cpu-dispatch=none bdist"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "A fatal error will be raised if "
                },
                {
                  "domain": null,
                  "role": null,
                  "type": "Directive",
                  "value": "native"
                },
                {
                  "type": "text",
                  "value": " isn't supported by the host platform."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        }
      ],
      "level": 2,
      "target": null,
      "title": "I am building NumPy for my local use",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Since most of the CPUs nowadays support at least "
            },
            {
              "domain": null,
              "role": null,
              "type": "Directive",
              "value": "AVX"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "domain": null,
              "role": null,
              "type": "Directive",
              "value": "F16C"
            },
            {
              "type": "text",
              "value": " features, you can use      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "python setup.py build --cpu-baseline=\"avx f16c\" bdist"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "inlineCode",
                  "value": "--cpu-baseline"
                },
                {
                  "type": "text",
                  "value": " force combine all implied features, so there's no need to add SSE features."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        }
      ],
      "level": 2,
      "target": null,
      "title": "I do not want to support the old processors of the `x86` architecture",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Then raise the ceiling of the baseline features to Power8      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "python setup.py build --cpu-baseline=\"vsx2\" bdist"
        }
      ],
      "level": 2,
      "target": null,
      "title": "I'm facing the same case above but with `ppc64` architecture",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "You may have some reservations about including of "
            },
            {
              "domain": null,
              "role": null,
              "type": "Directive",
              "value": "AVX512"
            },
            {
              "type": "text",
              "value": " or any other CPU feature and you want to exclude from the dispatched features      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "python setup.py build --cpu-dispatch=\"max -avx512f -avx512cd \\\n-avx512_knl -avx512_knm -avx512_skx -avx512_clx -avx512_cnl -avx512_icl\" \\\nbdist"
        }
      ],
      "level": 2,
      "target": null,
      "title": "Having issues with `AVX512` features?",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "The names of the features can express one feature or a group of features, as shown in the following tables supported depend on the lowest interest:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "The following features may not be supported by all compilers, also some compilers may produce different set of implied features when it comes to features like "
                },
                {
                  "type": "inlineCode",
                  "value": "AVX512"
                },
                {
                  "type": "text",
                  "value": ", "
                },
                {
                  "type": "inlineCode",
                  "value": "AVX2"
                },
                {
                  "type": "text",
                  "value": ", and "
                },
                {
                  "type": "inlineCode",
                  "value": "FMA3"
                },
                {
                  "type": "text",
                  "value": ". See "
                },
                {
                  "domain": null,
                  "role": "ref",
                  "type": "Directive",
                  "value": "opt-platform-differences"
                },
                {
                  "type": "text",
                  "value": " for more details."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        },
        {
          "args": "generated_tables/cpu_features.inc",
          "children": [],
          "name": "include",
          "options": {},
          "type": "mystDirective",
          "value": ""
        }
      ],
      "level": 1,
      "target": "opt-supported-features",
      "title": "Supported Features",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "NONE"
                    },
                    {
                      "type": "text",
                      "value": ": enable no features."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "NATIVE"
                    },
                    {
                      "type": "text",
                      "value": ": Enables all CPU features that supported by the host CPU,   this operation is based on the compiler flags ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "-march=native"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "-xHost"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/QxHost"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "MIN"
                    },
                    {
                      "type": "text",
                      "value": ": Enables the minimum CPU features that can safely run on a wide range of platforms:"
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "args": "",
                  "children": [],
                  "name": "table",
                  "options": {
                    "align": "left"
                  },
                  "type": "mystDirective",
                  "value": "======================================  =======================================\n   For Arch                               Implies\n  ======================================  =======================================\n   x86 (32-bit mode)                      ``SSE`` ``SSE2``\n   x86_64                                 ``SSE`` ``SSE2`` ``SSE3``\n   IBM/POWER (big-endian mode)            ``NONE``\n   IBM/POWER (little-endian mode)         ``VSX`` ``VSX2``\n   ARMHF                                  ``NONE``\n   ARM64 A.K. AARCH64                     ``NEON`` ``NEON_FP16`` ``NEON_VFPV4``\n                                          ``ASIMD``\n   IBM/ZSYSTEM(S390X)                     ``NONE``\n  ======================================  ======================================="
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "MAX"
                    },
                    {
                      "type": "text",
                      "value": ": Enables all supported CPU features by the compiler and platform."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Operators-/+"
                    },
                    {
                      "type": "text",
                      "value": ": remove or add features, useful with options "
                    },
                    {
                      "type": "inlineCode",
                      "value": "MAX"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "MIN"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "NATIVE"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        }
      ],
      "level": 1,
      "target": "opt-special-options",
      "title": "Special Options",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "CPU features and other options are case-insensitive, for example      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "python setup.py build --cpu-dispatch=\"SSE41 avx2 FMA3\""
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The order of the requested optimizations doesn't matter      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "python setup.py build --cpu-dispatch=\"SSE41 AVX2 FMA3\"\n# equivalent to\npython setup.py build --cpu-dispatch=\"FMA3 AVX2 SSE41\""
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Either commas or spaces or '+' can be used as a separator,   for example      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "python setup.py build --cpu-dispatch=\"avx2 avx512f\"\n# or\npython setup.py build --cpu-dispatch=avx2,avx512f\n# or\npython setup.py build --cpu-dispatch=\"avx2+avx512f\""
                },
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "all works but arguments should be enclosed in quotes or escaped   by backslash if any spaces are used."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "--cpu-baseline"
                    },
                    {
                      "type": "text",
                      "value": " combines all implied CPU features, for example      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "python setup.py build --cpu-baseline=sse42\n# equivalent to\npython setup.py build --cpu-baseline=\"sse sse2 sse3 ssse3 sse41 popcnt sse42\""
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "--cpu-baseline"
                    },
                    {
                      "type": "text",
                      "value": " will be treated as \"native\" if compiler native flag   "
                    },
                    {
                      "type": "inlineCode",
                      "value": "-march=native"
                    },
                    {
                      "type": "text",
                      "value": " or "
                    },
                    {
                      "type": "inlineCode",
                      "value": "-xHost"
                    },
                    {
                      "type": "text",
                      "value": " or "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/QxHost"
                    },
                    {
                      "type": "text",
                      "value": " is enabled through environment variable   "
                    },
                    {
                      "domain": null,
                      "role": null,
                      "type": "Directive",
                      "value": "CFLAGS"
                    },
                    {
                      "type": "text",
                      "value": ":      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "export CFLAGS=\"-march=native\"\npython setup.py install --user\n# is equivalent to\npython setup.py build --cpu-baseline=native install --user"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "--cpu-baseline"
                    },
                    {
                      "type": "text",
                      "value": " escapes any specified features that aren't supported   by the target platform or compiler rather than raising fatal errors."
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "note "
                            }
                          ],
                          "type": "admonitionTitle"
                        },
                        {
                          "children": [
                            {
                              "dd": [
                                {
                                  "children": [
                                    {
                                      "type": "text",
                                      "value": "supported of implied features will be enabled rather than escape all of them.    For example        "
                                    }
                                  ],
                                  "type": "paragraph"
                                },
                                {
                                  "type": "code",
                                  "value": "# Requesting `AVX2,FMA3` but the compiler only support **SSE** features\npython setup.py build --cpu-baseline=\"avx2 fma3\"\n# is equivalent to\npython setup.py build --cpu-baseline=\"sse sse2 sse3 ssse3 sse41 popcnt sse42\""
                                }
                              ],
                              "dt": {
                                "children": [
                                  {
                                    "type": "text",
                                    "value": "Since "
                                  },
                                  {
                                    "type": "inlineCode",
                                    "value": "--cpu-baseline"
                                  },
                                  {
                                    "type": "text",
                                    "value": " combines all implied features, the maximum"
                                  }
                                ],
                                "type": "paragraph"
                              },
                              "type": "DefListItem"
                            }
                          ],
                          "type": "DefList"
                        }
                      ],
                      "kind": "note",
                      "type": "admonition"
                    }
                  ],
                  "type": "blockquote"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "--cpu-dispatch"
                    },
                    {
                      "type": "text",
                      "value": " does not combain any of implied CPU features,   so you must add them unless you want to disable one or all of them      "
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "type": "code",
                  "value": "# Only dispatches AVX2 and FMA3\npython setup.py build --cpu-dispatch=avx2,fma3\n# Dispatches AVX and SSE features\npython setup.py build --cpu-baseline=ssse3,sse41,sse42,avx,avx2,fma3"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "--cpu-dispatch"
                    },
                    {
                      "type": "text",
                      "value": " escapes any specified baseline features and also escapes   any features not supported by the target platform or compiler without raising   fatal errors."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "Eventually, you should always check the final report through the build log to verify the enabled features. See "
            },
            {
              "type": "inlineCode",
              "value": "opt-build-report"
            },
            {
              "type": "text",
              "value": " for more details."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 1,
      "target": null,
      "title": "Behaviors",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Some exceptional conditions force us to link some features together when it come to certain compilers or architectures, resulting in the impossibility of building them separately."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "These conditions can be divided into two parts, as follows:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "Architectural compatibility"
                }
              ],
              "type": "strong"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "The need to align certain CPU features that are assured to be supported by successive generations of the same architecture, some cases:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "On ppc64le "
                    },
                    {
                      "type": "inlineCode",
                      "value": "VSX(ISA 2.06)"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "VSX2(ISA 2.07)"
                    },
                    {
                      "type": "text",
                      "value": " both imply one another since the   first generation that supports little-endian mode is Power-8`(ISA 2.07)`"
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "On AArch64 "
                    },
                    {
                      "type": "inlineCode",
                      "value": "NEON NEON_FP16 NEON_VFPV4 ASIMD"
                    },
                    {
                      "type": "text",
                      "value": " implies each other since they are part of the   hardware baseline."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "For example      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "# On ARMv8/A64, specify NEON is going to enable Advanced SIMD\n# and all predecessor extensions\npython setup.py build --cpu-baseline=neon\n# which equivalent to\npython setup.py build --cpu-baseline=\"neon neon_fp16 neon_vfpv4 asimd\""
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "Please take a deep look at "
                },
                {
                  "domain": null,
                  "role": "ref",
                  "type": "Directive",
                  "value": "opt-supported-features"
                },
                {
                  "type": "text",
                  "value": ", in order to determine the features that imply one another."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "Compilation compatibility"
                }
              ],
              "type": "strong"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "Some compilers don't provide independent support for all CPU features. For instance "
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "Intel"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": "'s compiler doesn't provide separated flags for "
            },
            {
              "type": "inlineCode",
              "value": "AVX2"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "FMA3"
            },
            {
              "type": "text",
              "value": ", it makes sense since all Intel CPUs that comes with "
            },
            {
              "type": "inlineCode",
              "value": "AVX2"
            },
            {
              "type": "text",
              "value": " also support "
            },
            {
              "type": "inlineCode",
              "value": "FMA3"
            },
            {
              "type": "text",
              "value": ", but this approach is incompatible with other "
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "x86"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": " CPUs from "
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "AMD"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": " or "
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "VIA"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": "."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "For example      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "# Specify AVX2 will force enables FMA3 on Intel compilers\npython setup.py build --cpu-baseline=avx2\n# which equivalent to\npython setup.py build --cpu-baseline=\"avx2 fma3\""
        },
        {
          "children": [
            {
              "type": "text",
              "value": "The following tables only show the differences imposed by some compilers from the general context that been shown in the "
            },
            {
              "type": "inlineCode",
              "value": "opt-supported-features"
            },
            {
              "type": "text",
              "value": " tables:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "note "
                }
              ],
              "type": "admonitionTitle"
            },
            {
              "children": [
                {
                  "type": "text",
                  "value": "Features names with strikeout represent the unsupported CPU features."
                }
              ],
              "type": "paragraph"
            }
          ],
          "kind": "note",
          "type": "admonition"
        },
        {
          "args": "html",
          "children": [],
          "name": "raw",
          "options": {},
          "type": "mystDirective",
          "value": "<style>\n    .enabled-feature {color:green; font-weight:bold;}\n    .disabled-feature {color:red; text-decoration: line-through;}\n</style>"
        },
        {
          "args": "enabled",
          "children": [],
          "name": "role",
          "options": {
            "class": "enabled-feature"
          },
          "type": "mystDirective",
          "value": ""
        },
        {
          "args": "disabled",
          "children": [],
          "name": "role",
          "options": {
            "class": "disabled-feature"
          },
          "type": "mystDirective",
          "value": ""
        },
        {
          "args": "generated_tables/compilers-diff.inc",
          "children": [],
          "name": "include",
          "options": {},
          "type": "mystDirective",
          "value": ""
        }
      ],
      "level": 1,
      "target": "opt-platform-differences",
      "title": "Platform differences",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "In most cases, the CPU build options do not produce any fatal errors that lead to hanging the build. Most of the errors that may appear in the build log serve as heavy warnings due to the lack of some expected CPU features by the compiler."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "So we strongly recommend checking the final report log, to be aware of what kind of CPU features are enabled and what are not."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "You can find the final report of CPU optimizations at the end of the build log, and here is how it looks on x86_64/gcc:"
            }
          ],
          "type": "paragraph"
        },
        {
          "args": "html",
          "children": [],
          "name": "raw",
          "options": {},
          "type": "mystDirective",
          "value": "<style>#build-report .highlight-bash pre{max-height:450px; overflow-y: scroll;}</style>"
        },
        {
          "args": "log_example.txt",
          "children": [],
          "name": "literalinclude",
          "options": {
            "language": "bash"
          },
          "type": "mystDirective",
          "value": ""
        },
        {
          "children": [
            {
              "type": "text",
              "value": "There is a separate report for each of "
            },
            {
              "type": "inlineCode",
              "value": "build_ext"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "build_clib"
            },
            {
              "type": "text",
              "value": " that includes several sections, and each section has several values, representing the following:"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "Platform"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": ":"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Architecture"
                    },
                    {
                      "type": "text",
                      "value": ": The architecture name of target CPU. It should be one of   "
                    },
                    {
                      "type": "inlineCode",
                      "value": "x86"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "x64"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ppc64"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ppc64le"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "armhf"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "aarch64"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "s390x"
                    },
                    {
                      "type": "text",
                      "value": " or "
                    },
                    {
                      "type": "inlineCode",
                      "value": "unknown"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Compiler"
                    },
                    {
                      "type": "text",
                      "value": ": The compiler name. It should be one of   gcc, clang, msvc, icc, iccw or unix-like."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "CPU baseline"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": ":"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Requested"
                    },
                    {
                      "type": "text",
                      "value": ": The specific features and options to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "--cpu-baseline"
                    },
                    {
                      "type": "text",
                      "value": " as-is."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Enabled"
                    },
                    {
                      "type": "text",
                      "value": ": The final set of enabled CPU features."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Flags"
                    },
                    {
                      "type": "text",
                      "value": ": The compiler flags that were used to all NumPy "
                    },
                    {
                      "domain": null,
                      "role": null,
                      "type": "Directive",
                      "value": "C/C++"
                    },
                    {
                      "type": "text",
                      "value": " sources   during the compilation except for temporary sources that have been used for generating   the binary objects of dispatched features."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Extra checks"
                    },
                    {
                      "type": "text",
                      "value": ": list of internal checks that activate certain functionality   or intrinsics related to the enabled features, useful for debugging when it comes   to developing SIMD kernels."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        },
        {
          "children": [
            {
              "children": [
                {
                  "type": "text",
                  "value": "CPU dispatch"
                }
              ],
              "type": "strong"
            },
            {
              "type": "text",
              "value": ":"
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Requested"
                    },
                    {
                      "type": "text",
                      "value": ": The specific features and options to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "--cpu-dispatch"
                    },
                    {
                      "type": "text",
                      "value": " as-is."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Enabled"
                    },
                    {
                      "type": "text",
                      "value": ": The final set of enabled CPU features."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "spread": false,
              "type": "listItem"
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "Generated"
                    },
                    {
                      "type": "text",
                      "value": ": At the beginning of the next row of this property,   the features for which optimizations have been generated are shown in the   form of several sections with similar properties explained as follows:"
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "inlineCode",
                              "value": "One or multiple dispatched feature"
                            },
                            {
                              "type": "text",
                              "value": ": The implied CPU features."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "inlineCode",
                              "value": "Flags"
                            },
                            {
                              "type": "text",
                              "value": ": The compiler flags that been used for these features."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "inlineCode",
                              "value": "Extra checks"
                            },
                            {
                              "type": "text",
                              "value": ": Similar to the baseline but for these dispatched features."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "inlineCode",
                              "value": "Detect"
                            },
                            {
                              "type": "text",
                              "value": ": Set of CPU features that need be detected in runtime in order to     execute the generated optimizations."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "The lines that come after the above property and end with a ':' on a separate line,     represent the paths of c/c++ sources that define the generated optimizations."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    }
                  ],
                  "ordered": false,
                  "spread": false,
                  "start": 1,
                  "type": "list"
                }
              ],
              "spread": false,
              "type": "listItem"
            }
          ],
          "ordered": false,
          "spread": false,
          "start": 1,
          "type": "list"
        }
      ],
      "level": 1,
      "target": "opt-build-report",
      "title": "Build report",
      "type": "Section"
    },
    {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Importing NumPy triggers a scan of the available CPU features from the set of dispatchable features. This can be further restricted by setting the environment variable "
            },
            {
              "type": "inlineCode",
              "value": "NPY_DISABLE_CPU_FEATURES"
            },
            {
              "type": "text",
              "value": " to a comma-, tab-, or space-separated list of features to disable. This will raise an error if parsing fails or if the feature was not enabled. For instance, on "
            },
            {
              "type": "inlineCode",
              "value": "x86_64"
            },
            {
              "type": "text",
              "value": " this will disable "
            },
            {
              "type": "inlineCode",
              "value": "AVX2"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "FMA3"
            },
            {
              "type": "text",
              "value": "      "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "NPY_DISABLE_CPU_FEATURES=\"AVX2,FMA3\""
        },
        {
          "children": [
            {
              "type": "text",
              "value": "If the feature is not available, a warning will be emitted."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 1,
      "target": "runtime-simd-dispatch",
      "title": "Runtime dispatch",
      "type": "Section"
    }
  ],
  "content": {},
  "example_section_data": {
    "children": [],
    "level": 0,
    "target": null,
    "title": null,
    "type": "Section"
  },
  "item_file": null,
  "item_line": null,
  "item_type": null,
  "ordered_sections": [],
  "references": null,
  "see_also": [],
  "signature": {
    "type": "Signature",
    "value": null
  },
  "type": "DocBlob"
}