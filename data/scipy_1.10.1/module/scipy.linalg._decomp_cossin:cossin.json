{
  "aliases": [
    "scipy.linalg.cossin"
  ],
  "arbitrary": [],
  "content": {
    "Attributes": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Extended Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "X is an "
            },
            {
              "type": "inlineCode",
              "value": "(m, m)"
            },
            {
              "type": "text",
              "value": " orthogonal/unitary matrix, partitioned as the following where upper left block has the shape of "
            },
            {
              "type": "inlineCode",
              "value": "(p, q)"
            },
            {
              "type": "text",
              "value": "                                 "
            }
          ],
          "type": "paragraph"
        },
        {
          "type": "code",
          "value": "                           \u250c                   \u2510\n                           \u2502 I  0  0 \u2502 0  0  0 \u2502\n\u250c           \u2510   \u250c         \u2510\u2502 0  C  0 \u2502 0 -S  0 \u2502\u250c         \u2510*\n\u2502 X11 \u2502 X12 \u2502   \u2502 U1 \u2502    \u2502\u2502 0  0  0 \u2502 0  0 -I \u2502\u2502 V1 \u2502    \u2502\n\u2502 \u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500 \u2502 = \u2502\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2502\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2502\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2502\n\u2502 X21 \u2502 X22 \u2502   \u2502    \u2502 U2 \u2502\u2502 0  0  0 \u2502 I  0  0 \u2502\u2502    \u2502 V2 \u2502\n\u2514           \u2518   \u2514         \u2518\u2502 0  S  0 \u2502 0  C  0 \u2502\u2514         \u2518\n                           \u2502 0  0  I \u2502 0  0  0 \u2502\n                           \u2514                   \u2518"
        },
        {
          "children": [
            {
              "type": "inlineCode",
              "value": "U1"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "U2"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "V1"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "V2"
            },
            {
              "type": "text",
              "value": " are square orthogonal/unitary matrices of dimensions "
            },
            {
              "type": "inlineCode",
              "value": "(p,p)"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "(m-p,m-p)"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "(q,q)"
            },
            {
              "type": "text",
              "value": ", and "
            },
            {
              "type": "inlineCode",
              "value": "(m-q,m-q)"
            },
            {
              "type": "text",
              "value": " respectively, and "
            },
            {
              "type": "inlineCode",
              "value": "C"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "S"
            },
            {
              "type": "text",
              "value": " are "
            },
            {
              "type": "inlineCode",
              "value": "(r, r)"
            },
            {
              "type": "text",
              "value": " nonnegative diagonal matrices satisfying "
            },
            {
              "type": "inlineCode",
              "value": "C^2 + S^2 = I"
            },
            {
              "type": "text",
              "value": " where "
            },
            {
              "type": "inlineCode",
              "value": "r = min(p, m-p, q, m-q)"
            },
            {
              "type": "text",
              "value": "."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "Moreover, the rank of the identity matrices are "
            },
            {
              "type": "inlineCode",
              "value": "min(p, q) - r"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "min(p, m - q) - r"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "min(m - p, q) - r"
            },
            {
              "type": "text",
              "value": ", and "
            },
            {
              "type": "inlineCode",
              "value": "min(m - p, m - q) - r"
            },
            {
              "type": "text",
              "value": " respectively."
            }
          ],
          "type": "paragraph"
        },
        {
          "children": [
            {
              "type": "text",
              "value": "X can be supplied either by itself and block specifications p, q or its subblocks in an iterable from which the shapes would be derived. See the examples below."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Methods": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Notes": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Other Parameters": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Parameters": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "complex unitary or real orthogonal matrix to be decomposed, or iterable of subblocks "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X11"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X12"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X21"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X22"
                    },
                    {
                      "type": "text",
                      "value": ", when "
                    },
                    {
                      "type": "inlineCode",
                      "value": "p"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "q"
                    },
                    {
                      "type": "text",
                      "value": " are omitted."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "X",
              "type": "Param",
              "type_": "array_like, iterable"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Number of rows of the upper left block "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X11"
                    },
                    {
                      "type": "text",
                      "value": ", used only when X is given as an array."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "p",
              "type": "Param",
              "type_": "int, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Number of columns of the upper left block "
                    },
                    {
                      "type": "inlineCode",
                      "value": "X11"
                    },
                    {
                      "type": "text",
                      "value": ", used only when X is given as an array."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "q",
              "type": "Param",
              "type_": "int, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "if "
                    },
                    {
                      "type": "inlineCode",
                      "value": "True"
                    },
                    {
                      "type": "text",
                      "value": ", the low level components are returned instead of the matrix factors, i.e. "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(u1,u2)"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "theta"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(v1h,v2h)"
                    },
                    {
                      "type": "text",
                      "value": " instead of "
                    },
                    {
                      "type": "inlineCode",
                      "value": "u"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "cs"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "vh"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "separate",
              "type": "Param",
              "type_": "bool, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "if "
                    },
                    {
                      "type": "inlineCode",
                      "value": "True"
                    },
                    {
                      "type": "text",
                      "value": ", the "
                    },
                    {
                      "type": "inlineCode",
                      "value": "-S"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "-I"
                    },
                    {
                      "type": "text",
                      "value": " block will be the bottom left, otherwise (by default) they will be in the upper right block."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "swap_sign",
              "type": "Param",
              "type_": "bool, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "if "
                    },
                    {
                      "type": "inlineCode",
                      "value": "False"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "u"
                    },
                    {
                      "type": "text",
                      "value": " won't be computed and an empty array is returned."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "compute_u",
              "type": "Param",
              "type_": "bool, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "if "
                    },
                    {
                      "type": "inlineCode",
                      "value": "False"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "vh"
                    },
                    {
                      "type": "text",
                      "value": " won't be computed and an empty array is returned."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "compute_vh",
              "type": "Param",
              "type_": "bool, optional"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Raises": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Receives": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Returns": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "When "
                    },
                    {
                      "type": "inlineCode",
                      "value": "compute_u=True"
                    },
                    {
                      "type": "text",
                      "value": ", contains the block diagonal orthogonal/unitary matrix consisting of the blocks "
                    },
                    {
                      "type": "inlineCode",
                      "value": "U1"
                    },
                    {
                      "type": "text",
                      "value": " ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "p"
                    },
                    {
                      "type": "text",
                      "value": " x "
                    },
                    {
                      "type": "inlineCode",
                      "value": "p"
                    },
                    {
                      "type": "text",
                      "value": ") and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "U2"
                    },
                    {
                      "type": "text",
                      "value": " ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "m-p"
                    },
                    {
                      "type": "text",
                      "value": " x "
                    },
                    {
                      "type": "inlineCode",
                      "value": "m-p"
                    },
                    {
                      "type": "text",
                      "value": ") orthogonal/unitary matrices. If "
                    },
                    {
                      "type": "inlineCode",
                      "value": "separate=True"
                    },
                    {
                      "type": "text",
                      "value": ", this contains the tuple of "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(U1, U2)"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "u",
              "type": "Param",
              "type_": "ndarray"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "dd": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "If "
                            },
                            {
                              "type": "inlineCode",
                              "value": "separate=True"
                            },
                            {
                              "type": "text",
                              "value": ", this contains the "
                            },
                            {
                              "type": "inlineCode",
                              "value": "theta"
                            },
                            {
                              "type": "text",
                              "value": " array containing the  angles in radians."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "dt": {
                        "children": [
                          {
                            "type": "text",
                            "value": "The cosine-sine factor with the structure described above."
                          }
                        ],
                        "type": "paragraph"
                      },
                      "type": "DefListItem"
                    }
                  ],
                  "type": "DefList"
                }
              ],
              "param": "cs",
              "type": "Param",
              "type_": "ndarray"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "When "
                    },
                    {
                      "type": "inlineCode",
                      "value": "compute_vh=True`, contains the block diagonal orthogonal/unitary\nmatrix consisting of the blocks ``V1H"
                    },
                    {
                      "type": "text",
                      "value": " ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "q"
                    },
                    {
                      "type": "text",
                      "value": " x "
                    },
                    {
                      "type": "inlineCode",
                      "value": "q"
                    },
                    {
                      "type": "text",
                      "value": ") and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "V2H"
                    },
                    {
                      "type": "text",
                      "value": " ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "m-q"
                    },
                    {
                      "type": "text",
                      "value": " x "
                    },
                    {
                      "type": "inlineCode",
                      "value": "m-q"
                    },
                    {
                      "type": "text",
                      "value": ") orthogonal/unitary matrices. If "
                    },
                    {
                      "type": "inlineCode",
                      "value": "separate=True"
                    },
                    {
                      "type": "text",
                      "value": ", this contains the tuple of "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(V1H, V2H)"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "vh",
              "type": "Param",
              "type_": "ndarray"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Compute the cosine-sine (CS) decomposition of an orthogonal/unitary matrix."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warnings": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warns": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Yields": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    }
  },
  "example_section_data": {
    "children": [
      {
        "type": "code",
        "value": "import numpy as np\nfrom scipy.linalg import cossin\nfrom scipy.stats import unitary_group\nx = unitary_group.rvs(4)\nu, cs, vdh = cossin(x, p=2, q=2)\nnp.allclose(x, u @ cs @ vdh)"
      },
      {
        "type": "text",
        "value": "Same can be entered via subblocks without the need of ``p`` and ``q``. Also\nlet's skip the computation of ``u``"
      },
      {
        "type": "code",
        "value": "ue, cs, vdh = cossin((x[:2, :2], x[:2, 2:], x[2:, :2], x[2:, 2:]),\n                     compute_u=False)\nprint(ue)"
      },
      {
        "type": "code",
        "value": "np.allclose(x, u @ cs @ vdh)"
      }
    ],
    "level": 0,
    "target": null,
    "title": null,
    "type": "Section"
  },
  "item_file": "/scipy/linalg/_decomp_cossin.py",
  "item_line": 12,
  "item_type": "<class 'function'>",
  "ordered_sections": [
    "Summary",
    "Extended Summary",
    "Parameters",
    "Returns",
    "References",
    "Examples"
  ],
  "references": null,
  "see_also": [],
  "signature": {
    "type": "Signature",
    "value": "(X, p=None, q=None, separate=False, swap_sign=False, compute_u=True, compute_vh=True)"
  },
  "type": "DocBlob"
}