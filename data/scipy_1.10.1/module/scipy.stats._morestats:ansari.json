{
  "aliases": [
    "scipy.stats.ansari"
  ],
  "arbitrary": [],
  "content": {
    "Attributes": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Extended Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "The Ansari-Bradley test (, ) is a non-parametric test for the equality of the scale parameter of the distributions from which two samples were drawn. The null hypothesis states that the ratio of the scale of the distribution underlying "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "x",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "x"
            },
            {
              "type": "text",
              "value": " to the scale of the distribution underlying "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "y",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "y"
            },
            {
              "type": "text",
              "value": " is 1."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Methods": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Notes": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "The p-value given is exact when the sample sizes are both less than 55 and there are no ties, otherwise a normal approximation for the p-value is used."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Other Parameters": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Parameters": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Arrays of sample data."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "x, y",
              "type": "Param",
              "type_": "array_like"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Defines the alternative hypothesis. Default is 'two-sided'. The following options are available:"
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "'two-sided': the ratio of scales is not equal to 1."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "'less': the ratio of scales is less than 1."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "type": "text",
                              "value": "'greater': the ratio of scales is greater than 1."
                            }
                          ],
                          "type": "paragraph"
                        }
                      ],
                      "spread": false,
                      "type": "listItem"
                    }
                  ],
                  "ordered": false,
                  "spread": false,
                  "start": 1,
                  "type": "list"
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "type": "text",
                          "value": "versionadded 1.7.0"
                        }
                      ],
                      "type": "admonitionTitle"
                    }
                  ],
                  "kind": "note",
                  "type": "admonition"
                }
              ],
              "param": "alternative",
              "type": "Param",
              "type_": "{'two-sided', 'less', 'greater'}, optional"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Raises": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Receives": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Returns": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The Ansari-Bradley test statistic."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "statistic",
              "type": "Param",
              "type_": "float"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The p-value of the hypothesis test."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "pvalue",
              "type": "Param",
              "type_": "float"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Perform the Ansari-Bradley test for equal scale parameters."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warnings": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warns": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Yields": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    }
  },
  "example_section_data": {
    "children": [
      {
        "type": "code",
        "value": "import numpy as np\nfrom scipy.stats import ansari\nrng = np.random.default_rng()"
      },
      {
        "type": "text",
        "value": "For these examples, we'll create three random data sets.  The first\ntwo, with sizes 35 and 25, are drawn from a normal distribution with\nmean 0 and standard deviation 2.  The third data set has size 25 and\nis drawn from a normal distribution with standard deviation 1.25."
      },
      {
        "type": "code",
        "value": "x1 = rng.normal(loc=0, scale=2, size=35)\nx2 = rng.normal(loc=0, scale=2, size=25)\nx3 = rng.normal(loc=0, scale=1.25, size=25)"
      },
      {
        "type": "text",
        "value": "First we apply `ansari` to `x1` and `x2`.  These samples are drawn\nfrom the same distribution, so we expect the Ansari-Bradley test\nshould not lead us to conclude that the scales of the distributions\nare different."
      },
      {
        "type": "code",
        "value": "ansari(x1, x2)"
      },
      {
        "type": "text",
        "value": "With a p-value close to 1, we cannot conclude that there is a\nsignificant difference in the scales (as expected)."
      },
      {
        "type": "text",
        "value": "Now apply the test to `x1` and `x3`:"
      },
      {
        "type": "code",
        "value": "ansari(x1, x3)"
      },
      {
        "type": "text",
        "value": "The probability of observing such an extreme value of the statistic\nunder the null hypothesis of equal scales is only 0.03087%. We take this\nas evidence against the null hypothesis in favor of the alternative:\nthe scales of the distributions from which the samples were drawn\nare not equal."
      },
      {
        "type": "text",
        "value": "We can use the `alternative` parameter to perform a one-tailed test.\nIn the above example, the scale of `x1` is greater than `x3` and so\nthe ratio of scales of `x1` and `x3` is greater than 1. This means\nthat the p-value when ``alternative='greater'`` should be near 0 and\nhence we should be able to reject the null hypothesis:"
      },
      {
        "type": "code",
        "value": "ansari(x1, x3, alternative='greater')"
      },
      {
        "type": "text",
        "value": "As we can see, the p-value is indeed quite low. Use of\n``alternative='less'`` should thus yield a large p-value:"
      },
      {
        "type": "code",
        "value": "ansari(x1, x3, alternative='less')"
      }
    ],
    "level": 0,
    "target": null,
    "title": null,
    "type": "Section"
  },
  "item_file": "/scipy/stats/_morestats.py",
  "item_line": 2319,
  "item_type": "<class 'function'>",
  "ordered_sections": [
    "Summary",
    "Extended Summary",
    "Parameters",
    "Returns",
    "See Also",
    "Notes",
    "References",
    "Examples"
  ],
  "references": null,
  "see_also": [
    {
      "descriptions": [
        {
          "children": [
            {
              "type": "text",
              "value": "A non-parametric test for the equality of k variances"
            }
          ],
          "type": "paragraph"
        }
      ],
      "name": {
        "anchor": null,
        "exists": true,
        "kind": "module",
        "reference": {
          "kind": "module",
          "module": "scipy",
          "path": "scipy.stats._morestats:fligner",
          "type": "RefInfo",
          "version": "1.10.1"
        },
        "type": "Link",
        "value": "fligner"
      },
      "type": null
    },
    {
      "descriptions": [
        {
          "children": [
            {
              "type": "text",
              "value": "A non-parametric test for the equality of two scale parameters"
            }
          ],
          "type": "paragraph"
        }
      ],
      "name": {
        "anchor": null,
        "exists": true,
        "kind": "module",
        "reference": {
          "kind": "to-resolve",
          "module": "current-module",
          "path": "mood",
          "type": "RefInfo",
          "version": "current-version"
        },
        "type": "Link",
        "value": "mood"
      },
      "type": null
    }
  ],
  "signature": {
    "type": "Signature",
    "value": "(x, y, alternative='two-sided')"
  },
  "type": "DocBlob"
}