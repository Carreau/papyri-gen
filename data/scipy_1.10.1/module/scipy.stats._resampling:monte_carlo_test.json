{
  "aliases": [
    "scipy.stats.monte_carlo_test"
  ],
  "arbitrary": [],
  "content": {
    "Attributes": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Extended Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "The null hypothesis is that the provided "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "sample",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "sample"
            },
            {
              "type": "text",
              "value": " was drawn at random from the distribution for which "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "rvs",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "rvs"
            },
            {
              "type": "text",
              "value": " generates random variates. The value of the "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "statistic",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "statistic"
            },
            {
              "type": "text",
              "value": " for the given sample is compared against a Monte Carlo null distribution: the value of the statistic for each of "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "n_resamples",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "n_resamples"
            },
            {
              "type": "text",
              "value": " samples generated by "
            },
            {
              "anchor": null,
              "exists": true,
              "kind": "local",
              "reference": {
                "kind": "local",
                "module": null,
                "path": "rvs",
                "type": "RefInfo",
                "version": null
              },
              "type": "Link",
              "value": "rvs"
            },
            {
              "type": "text",
              "value": ". This gives the p-value, the probability of observing such an extreme value of the test statistic under the null hypothesis."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Methods": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Notes": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Other Parameters": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Parameters": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "An array of observations."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "sample",
              "type": "Param",
              "type_": "array-like"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Generates random variates from the distribution against which "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "sample",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "sample"
                    },
                    {
                      "type": "text",
                      "value": " will be tested. "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "rvs",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "rvs"
                    },
                    {
                      "type": "text",
                      "value": " must be a callable that accepts keyword argument "
                    },
                    {
                      "type": "inlineCode",
                      "value": "size"
                    },
                    {
                      "type": "text",
                      "value": " (e.g. "
                    },
                    {
                      "type": "inlineCode",
                      "value": "rvs(size=(m, n))"
                    },
                    {
                      "type": "text",
                      "value": ") and returns an N-d array sample of that shape."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "rvs",
              "type": "Param",
              "type_": "callable"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Statistic for which the p-value of the hypothesis test is to be calculated. "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": " must be a callable that accepts a sample (e.g. "
                    },
                    {
                      "type": "inlineCode",
                      "value": "statistic(sample)"
                    },
                    {
                      "type": "text",
                      "value": ") and returns the resulting statistic. If "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "vectorized",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "vectorized"
                    },
                    {
                      "type": "text",
                      "value": " is set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "True"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": " must also accept a keyword argument "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "axis",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " and be vectorized to compute the statistic along the provided "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "axis",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " of the sample array."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "statistic",
              "type": "Param",
              "type_": "callable"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "If "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "vectorized",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "vectorized"
                    },
                    {
                      "type": "text",
                      "value": " is set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "False"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": " will not be passed keyword argument "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "axis",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " and is expected to calculate the statistic only for 1D samples. If "
                    },
                    {
                      "type": "inlineCode",
                      "value": "True"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": " will be passed keyword argument "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "axis",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " and is expected to calculate the statistic along "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "axis",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " when passed an ND sample array. If "
                    },
                    {
                      "type": "inlineCode",
                      "value": "None"
                    },
                    {
                      "type": "text",
                      "value": " (default), "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "vectorized",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "vectorized"
                    },
                    {
                      "type": "text",
                      "value": " will be set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "True"
                    },
                    {
                      "type": "text",
                      "value": " if "
                    },
                    {
                      "type": "inlineCode",
                      "value": "axis"
                    },
                    {
                      "type": "text",
                      "value": " is a parameter of "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": ". Use of a vectorized statistic typically reduces computation time."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "vectorized",
              "type": "Param",
              "type_": "bool, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "Number of random permutations used to approximate the Monte Carlo null distribution."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "n_resamples",
              "type": "Param",
              "type_": "int, default: 9999"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The number of permutations to process in each call to "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "statistic",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "statistic"
                    },
                    {
                      "type": "text",
                      "value": ". Memory usage is O("
                    },
                    {
                      "domain": null,
                      "role": null,
                      "type": "Directive",
                      "value": "batch'*''sample.size[axis]'"
                    },
                    {
                      "type": "text",
                      "value": "). Default is "
                    },
                    {
                      "type": "inlineCode",
                      "value": "None"
                    },
                    {
                      "type": "text",
                      "value": ", in which case "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "batch",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "batch"
                    },
                    {
                      "type": "text",
                      "value": " equals "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "n_resamples",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "n_resamples"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "batch",
              "type": "Param",
              "type_": "int, optional"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The alternative hypothesis for which the p-value is calculated. For each alternative, the p-value is defined as follows."
                    }
                  ],
                  "type": "paragraph"
                },
                {
                  "children": [
                    {
                      "children": [],
                      "spread": false,
                      "type": "listItem"
                    }
                  ],
                  "ordered": false,
                  "spread": false,
                  "start": 1,
                  "type": "list"
                }
              ],
              "param": "alternative",
              "type": "Param",
              "type_": "{'two-sided', 'less', 'greater'}"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The axis of "
                    },
                    {
                      "anchor": null,
                      "exists": true,
                      "kind": "local",
                      "reference": {
                        "kind": "local",
                        "module": null,
                        "path": "sample",
                        "type": "RefInfo",
                        "version": null
                      },
                      "type": "Link",
                      "value": "sample"
                    },
                    {
                      "type": "text",
                      "value": " over which to calculate the statistic."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "axis",
              "type": "Param",
              "type_": "int, default: 0"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Raises": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Receives": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Returns": {
      "children": [
        {
          "children": [
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The observed test statistic of the sample."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "statistic",
              "type": "Param",
              "type_": "float or ndarray"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The p-value for the given alternative."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "pvalue",
              "type": "Param",
              "type_": "float or ndarray"
            },
            {
              "desc": [
                {
                  "children": [
                    {
                      "type": "text",
                      "value": "The values of the test statistic generated under the null hypothesis."
                    }
                  ],
                  "type": "paragraph"
                }
              ],
              "param": "null_distribution",
              "type": "Param",
              "type_": "ndarray"
            }
          ],
          "type": "Parameters"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Summary": {
      "children": [
        {
          "children": [
            {
              "type": "text",
              "value": "Monte Carlo test that a sample is drawn from a given distribution."
            }
          ],
          "type": "paragraph"
        }
      ],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warnings": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Warns": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    },
    "Yields": {
      "children": [],
      "level": 0,
      "target": null,
      "title": null,
      "type": "Section"
    }
  },
  "example_section_data": {
    "children": [
      {
        "type": "text",
        "value": "Suppose we wish to test whether a small sample has been drawn from a normal\ndistribution. We decide that we will use the skew of the sample as a\ntest statistic, and we will consider a p-value of 0.05 to be statistically\nsignificant."
      },
      {
        "type": "code",
        "value": "import numpy as np\nfrom scipy import stats\ndef statistic(x, axis):\n    return stats.skew(x, axis)"
      },
      {
        "type": "text",
        "value": "After collecting our data, we calculate the observed value of the test\nstatistic."
      },
      {
        "type": "code",
        "value": "rng = np.random.default_rng()\nx = stats.skewnorm.rvs(a=1, size=50, random_state=rng)\nstatistic(x, axis=0)"
      },
      {
        "type": "text",
        "value": "To determine the probability of observing such an extreme value of the\nskewness by chance if the sample were drawn from the normal distribution,\nwe can perform a Monte Carlo hypothesis test. The test will draw many\nsamples at random from their normal distribution, calculate the skewness\nof each sample, and compare our original skewness against this\ndistribution to determine an approximate p-value."
      },
      {
        "type": "code",
        "value": "from scipy.stats import monte_carlo_test\n# because our statistic is vectorized, we pass `vectorized=True`\nrvs = lambda size: stats.norm.rvs(size=size, random_state=rng)\nres = monte_carlo_test(x, rvs, statistic, vectorized=True)\nprint(res.statistic)"
      },
      {
        "type": "code",
        "value": "print(res.pvalue)"
      },
      {
        "type": "text",
        "value": "The probability of obtaining a test statistic less than or equal to the\nobserved value under the null hypothesis is ~70%. This is greater than\nour chosen threshold of 5%, so we cannot consider this to be significant\nevidence against the null hypothesis."
      },
      {
        "type": "text",
        "value": "Note that this p-value essentially matches that of\n`scipy.stats.skewtest`, which relies on an asymptotic distribution of a\ntest statistic based on the sample skewness."
      },
      {
        "type": "code",
        "value": "stats.skewtest(x).pvalue"
      },
      {
        "type": "text",
        "value": "This asymptotic approximation is not valid for small sample sizes, but\n`monte_carlo_test` can be used with samples of any size."
      },
      {
        "type": "code",
        "value": "x = stats.skewnorm.rvs(a=1, size=7, random_state=rng)\n# stats.skewtest(x) would produce an error due to small sample\nres = monte_carlo_test(x, rvs, statistic, vectorized=True)"
      },
      {
        "type": "text",
        "value": "The Monte Carlo distribution of the test statistic is provided for\nfurther investigation."
      },
      {
        "type": "code",
        "value": "import matplotlib.pyplot as plt\nfig, ax = plt.subplots()\nax.hist(res.null_distribution, bins=50)\nax.set_title(\"Monte Carlo distribution of test statistic\")\nax.set_xlabel(\"Value of Statistic\")\nax.set_ylabel(\"Frequency\")\nplt.show()"
      },
      {
        "type": "Fig",
        "value": {
          "kind": "assets",
          "module": "scipy",
          "path": "fig-scipy.stats._resampling:monte_carlo_test-0-f33afe66.png",
          "type": "RefInfo",
          "version": "1.10.1"
        }
      }
    ],
    "level": 0,
    "target": null,
    "title": null,
    "type": "Section"
  },
  "item_file": "/scipy/stats/_resampling.py",
  "item_line": 669,
  "item_type": "<class 'function'>",
  "ordered_sections": [
    "Summary",
    "Extended Summary",
    "Parameters",
    "Returns",
    "References",
    "Examples"
  ],
  "references": null,
  "see_also": [],
  "signature": {
    "type": "Signature",
    "value": "(sample, rvs, statistic, *, vectorized=None, n_resamples=9999, batch=None, alternative='two-sided', axis=0)"
  },
  "type": "DocBlob"
}